# java-filmorate

Filmorate — это приложение, которое поможет выбирать фильмы для просмотра, основываясь на оценках пользователей и рекомендациях. 

## Схема базы данных

![Диаграмма базы данных](src/main/resources/images/filmorate_ER.png)

### Таблицы и их назначения

- **films**: Хранит информацию о фильмах, включая название, описание, дату выхода и продолжительность.
- **users**: Хранит данные о пользователях, такие как электронная почта, логин, имя и дата рождения.
- **likes**: Служит для хранения информации о том, какие пользователи поставили лайк каким фильмам.
- **friends**: Хранит информацию о дружеских связях между пользователями.
- **genres**: Связывает фильмы с жанрами через идентификаторы.
- **film_genre**: Определяет жанры фильмов с уникальными идентификаторами и названиями.


### Принципы проектирования

- Каждый столбец содержит только одно значение. Массивы или вложенные записи не используются, что соответствует правилу первой нормальной формы (1NF).
- Каждая таблица имеет первичный ключ (например, id в таблицах films, users, и film_genre), и все неключевые атрибуты (например, name, email, description) однозначно определяются этим ключом. Это соответствует правилу второй нормальной формы (2NF).
- Неключевые атрибуты в каждой таблице зависят только от первичного ключа и не зависят от других неключевых атрибутов. Например, в таблице users столбцы email, login, name и birthday зависят только от id, а не друг от друга. Это соответствует правилу третьей нормальной формы (3NF).

### Основные операции и примеры запросов

#### Получение всех фильмов

```sql
SELECT * FROM films;
```

#### Получение всех пользователей

```sql
SELECT * FROM users;
```

#### Получение топ-N наиболее популярных фильмов

```sql
SELECT films.id, films.name, COUNT(likes.film_id) AS likes_count
FROM films
LEFT JOIN likes ON films.id = likes.film_id
GROUP BY films.id, films.name
ORDER BY likes_count DESC
LIMIT N;
```

#### Получение списка общих друзей с другим пользователем

```sql
SELECT u2.id, u2.name
FROM friends f1
JOIN friends f2 ON f1.friend_id = f2.friend_id
JOIN users u2 ON f2.friend_id = u2.id
WHERE f1.user_id = ? AND f2.user_id = ?;
```

#### Добавление признака дружба

```sql
INSERT INTO friends (user_id, friend_id, friendship) VALUES (?, ?, true);
```
##  Структура проекта

### Модели данных

В проекте используются следующие модели данных:

- Film

- User

### Хранение данных

На текущем этапе данные хранятся в памяти приложения. 

### Валидация

Для обеспечения корректности данных используется валидация. 

### Логирование

Логирование добавлено для операций изменения сущностей и для причин ошибок валидации.

### Тестирование

Добавлены unit-тесты для валидации моделей и тестирование API с помощью Postman.




